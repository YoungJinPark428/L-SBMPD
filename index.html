<!DOCTYPE html>
<html lang="ko"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ESWA 파라변경/부동내역 공유 양식</title>
    <style>
        body {
            font-family: 'Malgun Gothic', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f0f0;
            color: #333;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
        }
        .header {
            background-color: #4a4a4a;
            color: white;
            padding: 20px;
            text-align: center;
            border-radius: 5px 5px 0 0;
        }
        .tab-container {
            display: flex;
            background-color: #e0e0e0;
        }
        .tab {
            flex: 1;
            text-align: center;
            padding: 15px;
            cursor: pointer;
            font-weight: bold;
        }
        .tab.active {
            background-color: white;
        }
        .form-container {
            background-color: white;
            padding: 20px;
            border-radius: 0 0 5px 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        .form {
            display: none;
        }
        .form.active {
            display: block;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        textarea {
            height: 100px;
            resize: vertical;
        }
        .button {
            background-color: #4a4a4a;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            width: 100%;
            margin-top: 10px;
        }
        .button:hover {
            background-color: #5a5a5a;
        }
        .footer {
            text-align: right;
            padding: 10px;
            font-size: 12px;
            color: #666;
            margin-top: 20px;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 4px;
            display: none;
        }
        #copyButton {
            margin-right: 10px;
            background-color: #28a745;
        }
        #shareButton {
            background-color: #4267B2;
            color: white;
        }
    </style>
    <!-- 카카오 SDK 제거 - Web Share API 사용 -->
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ESWA 파라변경이력 부동내역 양식</h1>
            <p>Parameter 변경이력 및 부동&amp;작업내역 양식 입력</p>
        </div>
        
        <div class="tab-container">
          <div class="tab" onclick="switchTab(&#39;parameterForm&#39;)">Para/IP 변경공유</div>
          <div class="tab active" onclick="switchTab(&#39;troubleForm&#39;)">부동내역 공유</div>



           <!--div class="tab active" onclick="switchTab(&#39;parameterForm&#39;)">Para/IP 변경공유</div--!>
           <!--div class="tab" onclick="switchTab(&#39;troubleForm&#39;)">부동내역 공유</div--!>

        </div>
        
        <div class="form-container">
            <!-- 파라미터 변경 폼 -->
            <div id="parameterForm" class="form">
            <!-- 원래거 div id="parameterForm" class="form active" -->


                <div class="form-group">
                    <label for="para-machine">1. 호기 :</label>
                    <select id="para-machine">
                        <option value="26-1">26-1</option>
                        <option value="26-2">26-2</option>
                        <option value="26-3">26-3</option>
                        <option value="26-4">26-4</option>
                        <option value="26-5">26-5</option>
                        <option value="27-1">27-1</option>
                        <option value="27-2">27-2</option>
                        <option value="27-3">27-3</option>
                        <option value="27-4">27-4</option>
                        <option value="27-5">27-5</option>
                        <option value="28-1">28-1</option>
                        <option value="28-2">28-2</option>
                        <option value="28-3">28-3</option>
                        <option value="28-4">28-4</option>
                        <option value="28-5">28-5</option>
                        <option value="28-6">28-6</option>
                        <option value="29-1">29-1</option>
                        <option value="29-2">29-2</option>
                        <option value="29-3">29-3</option>
                        <option value="26-H">26-H</option>


                    </select>
                </div>

                <div class="form-group">
                    <label for="para-process">2-1. Machine :</label>
                    <select id="para-process">
                        <option value="-">-</option>
                        <option value="Electrode Supply">Electrode Supply</option>
                        <option value="Lamination">Lamination</option>
                        <option value="D-Stacking">D-Stacking</option>
                        <option value="Taper">Taper</option>
                        <option value="Inspection">Inspection</option>
                    </select>
                </div>


                <div class="form-group">
                    <label for="para-unit">2-2. UNIT :</label>
                    <select id="para-unit">
                        <option value="-">-</option>

                    </select>
                </div>

                <div class="form-group">
                    <label for="para-assy">2-3. Assy' :</label>
                    <select id="para-assy">
                        <option value="-">-</option>

                    </select>
                </div>


                <div class="form-group">
                    <label for="para-time">3. 변경시간 :</label>
                    <input type="datetime-local" id="para-time">
                </div>
                <div class="form-group">
                    <label for="para-parameter">4. 변경Para :</label>
                    <input type="text" id="para-parameter" placeholder="변경 파라미터 입력">
                </div>
                <div class="form-group">
                    <label for="para-before">5. 이전값 :</label>
                    <input type="text" id="para-before" placeholder="이전 값 입력">
                </div>
                <div class="form-group">
                    <label for="para-after">6. 변경값 :</label>
                    <input type="text" id="para-after" placeholder="변경 값 입력">
                </div>
                <div class="form-group">
                    <label for="para-worker">7. 변경자 :</label>
                    <input type="text" id="para-worker" placeholder="작업자 이름">
                </div>
                <div class="form-group">
                    <label for="para-reason">8. 변경사유 :</label>
                    <textarea id="para-reason" placeholder="변경 사유 입력"></textarea>
                </div>
                <button class="button" onclick="generateParameterText()">양식 생성하기</button>
            </div>
            
            <!-- 부동내역 폼 -->

            <!-- 원래거 div id="troubleForm" class="form" -->
            <div id="troubleForm" class="form active">
                <div class="form-group">
                    <label for="trouble-type">종류 :</label>
                    <input type="text" id="trouble-type" placeholder="예: BM/PD/재료교체 등">                    
                </div>
                <div class="form-group">
                    <label for="trouble-machine">1. 호기 :</label>
                    <select id="trouble-machine">
                        <option value="26-1">26-1</option>
                        <option value="26-2">26-2</option>
                        <option value="26-3">26-3</option>
                        <option value="26-4">26-4</option>
                        <option value="26-5">26-5</option>
                        <option value="27-1">27-1</option>
                        <option value="27-2">27-2</option>
                        <option value="27-3">27-3</option>
                        <option value="27-4">27-4</option>
                        <option value="27-5">27-5</option>
                        <option value="28-1">28-1</option>
                        <option value="28-2">28-2</option>
                        <option value="28-3">28-3</option>
                        <option value="28-4">28-4</option>
                        <option value="28-5">28-5</option>
                        <option value="28-6">28-6</option>
                        <option value="29-1">29-1</option>
                        <option value="29-2">29-2</option>
                        <option value="29-3">29-3</option>
                        <option value="26-H">26-H</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="trouble-process">2-1. Machine :</label>
                    <select id="trouble-process">
                        <option value="-">-</option>
                        <option value="Electrode Supply">Electrode Supply</option>
                        <option value="Lamination">Lamination</option>
                        <option value="D-Stacking">D-Stacking</option>
                        <option value="Taper">Taper</option>
                        <option value="Inspection">Inspection</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="trouble-unit">2-2. UNIT :</label>
                    <select id="trouble-unit">
                        <option value="-">-</option>

                    </select>
                </div>

                <div class="form-group">
                    <label for="trouble-assy">2-3. Assy' :</label>
                    <select id="trouble-assy">
                        <option value="-">-</option>

                    </select>
                </div>


                <div class="form-group">
                    <label for="trouble-time">3-1. 발생시간 :</label>
                    <input type="datetime-local" id="trouble-time">
                </div>
                <div class="form-group">
                    <label for="trouble-complete">3-2. 조치완료 :</label>
                    <input type="datetime-local" id="trouble-complete">
                </div>
                <div class="form-group">
                    <label for="trouble-worker">4. 작업자 :</label>
                    <input type="text" id="trouble-worker" placeholder="작업자 이름">
                </div>
                <div class="form-group">
                    <label for="trouble-problem">5. 현상 :</label>
                    <textarea id="trouble-problem" placeholder="현상 입력"></textarea>
                </div>
                <div class="form-group">
                    <label for="trouble-action">6. 조치 :</label>
                    <textarea id="trouble-action" placeholder="조치 내용 입력"></textarea>
                </div>
                <button class="button" onclick="generateTroubleText()">양식 생성하기</button>
            </div>
            
            <!-- 결과 표시 영역 -->
            <div id="result" class="result">
                <p id="resultText"></p>
                <div>
                    <button id="copyButton" class="button" onclick="copyText()">복사하기</button>
                    <button id="shareButton" class="button" onclick="shareContent()">공유하기</button>
                </div>
            </div>
        </div>
        
        <div class="footer">
            @
        </div>
    </div>

    <script>
        // 파라유닛 선택항목 함수
document.getElementById('para-process').addEventListener('change', function () {
    const process = this.value;
    const unitSelect = document.getElementById('para-unit');

    // 기존 옵션 제거
    unitSelect.innerHTML = '';

    let options = [];
    if (process === 'Electrode Supply') {
        options = ['-', 'Pancake.Loader'];
    } else if (process === 'Lamination') {
        options = ['-', 'Separator. Unwinder', 'Electrode/Separator.Combiner', 'Laminator', 'Cell.FinalCutter', 'Cell.TrackingSystem', 'Cell.Inspector', 'Cell.Unloader'];
    } else if (process === 'D-Stacking') {
        options = ['-', '[01]Cell.Loading C/V', '[02]Cell.Loading C/V', '[01]Cell.Stacker', '[02]Cell.Stacker', '[03]Cell.Stacker', 'Stacked Cell.Transfer'];
    } else if (process === 'Taper') {
        options = ['-', 'HalfCell.Loading', 'HalfCell.Stack', 'LMS', '[01]StackedCell.Taper', '[02]StackedCell.Taper'];
    } else if (process === 'Inspection') {
        options = ['-', 'TapedCell.Vision', 'TapedCell.Rotate', 'TapedCell.ShortInspector', 'Cell.TrackingSystem', 'TapedCell.Transfer', 'TapedCell.Unloader'];
    }
      else {
        options = ['기타']; // 기본값 또는 공정 외 항목 처리
    }

    options.forEach(function (opt) {
        const option = document.createElement('option');
        option.value = opt;
        option.textContent = opt;
        unitSelect.appendChild(option);
    });
});




        // 트러블유닛 선택항목 함수
document.getElementById('trouble-process').addEventListener('change', function () {
    const process = this.value;
    const unitSelect = document.getElementById('trouble-unit');

    // 기존 옵션 제거
    unitSelect.innerHTML = '';

    let options = [];
    if (process === 'Electrode Supply') {
        options = ['-', 'Pancake.Loader'];
    } else if (process === 'Lamination') {
        options = ['-', 'Separator. Unwinder', 'Electrode/Separator.Combiner', 'Laminator', 'Cell.FinalCutter', 'Cell.TrackingSystem', 'Cell.Inspector', 'Cell.Unloader'];
    } else if (process === 'D-Stacking') {
        options = ['-', '[01]Cell.Loading C/V', '[02]Cell.Loading C/V', '[01]Cell.Stacker', '[02]Cell.Stacker', '[03]Cell.Stacker', 'Stacked Cell.Transfer'];
    } else if (process === 'Taper') {
        options = ['-', 'HalfCell.Loading', 'HalfCell.Stack', 'LMS', '[01]StackedCell.Taper', '[02]StackedCell.Taper'];
    } else if (process === 'Inspection') {
        options = ['-', 'TapedCell.Vision', 'TapedCell.Rotate', 'TapedCell.ShortInspector', 'Cell.TrackingSystem', 'TapedCell.Transfer', 'TapedCell.Unloader'];
    }
      else {
        options = ['기타']; // 기본값 또는 공정 외 항목 처리
    }

    options.forEach(function (opt) {
        const option = document.createElement('option');
        option.value = opt;
        option.textContent = opt;
        unitSelect.appendChild(option);
    });
});



// para-assy 연동 (Unit에 따라 Assy 설정)
document.getElementById('para-unit').addEventListener('change', function () {
    const unit = this.value;
    const assySelect = document.getElementById('para-assy');
    assySelect.innerHTML = '';

    let options = [];
    if (unit === 'Pancake.Loader') {
        options = ['-', '[01/A] Pancake. Conveyor', '[01/B] Pancake. Conveyor', '[01/C] Pancake. Conveyor', '[02/A] Pancake. Conveyor', '[02B] Pancake. Conveyor', '[02/C] Pancake. Conveyor', 'Pancake. Hoist', '[01/A] Pancake. Unwinder', '[02/A] Pancake. Unwinder', '[03/A] Pancake. Unwinder', '[04/A] Pancake. Unwinder', '[01/B] Pancake. Unwinder', '[02/B] Pancake. Unwinder', '[03/B] Pancake. Unwinder', '[04/B] Pancake. Unwinder', '[01/A] Electrode. Vacuum Plate', '[02/A] Electrode. Vacuum Plate', '[03/A] Electrode. Vacuum Plate', '[04/A] Electrode. Vacuum Plate', '[01/B] Electrode. Vacuum Plate', '[02/B] Electrode. Vacuum Plate', '[03/B] Electrode. Vacuum Plate', '[04/B] Electrode. Vacuum Plate', '[01/A] Electrode. Auto Splicer Cutter', '[02/A] Electrode. Auto Splicer Cutter', '[03/A] Electrode. Auto Splicer Cutter', '[04/A] Electrode. Auto Splicer Cutter', '[01/B] Electrode. Auto Splicer Cutter', '[02/B] Electrode. Auto Splicer Cutter', '[03/B] Electrode. Auto Splicer Cutter', '[04/B] Electrode. Auto Splicer Cutter', 'Electrode. Tape Feeder', 'Electrode. Scrape Box', '[01/A] Electrode. Idle Roller', '[02/A] Electrode. Idle Roller', '[01/B] Electrode. Idle Roller', '[02/B] Electrode. Idle Roller', '[01/A] Dancer. Roller', '[02/A] Dancer. Roller', '[01/B] Dancer. Roller', '[02/B] Dancer. Roller', '[01/A] Adjust Roller', '[02/A] Adjust Roller', '[01/B] Adjust Roller', '[02/B] Adjust Roller', '[01/A] Electrode. EPC', '[02/A] Electrode. EPC', '[03/A] Electrode. EPC', '[04/A] Electrode. EPC', '[01/B] Electrode. EPC', '[02/B] Electrode. EPC', '[03/B] Electrode. EPC', '[04/B] Electrode. EPC', '[01/A] Winder Diameter Sensor', '[02/A] Winder Diameter Sensor', '[03/A] Winder Diameter Sensor', '[04/A] Winder Diameter Sensor', '[01/B] Winder Diameter Sensor', '[02/B] Winder Diameter Sensor', '[03/B] Winder Diameter Sensor', '[04/B] Winder Diameter Sensor', '[01/A] PET tape sensor', '[02/A] PET tape sensor', '[03/A] PET tape sensor', '[04/A] PET tape sensor', '[01/B] PET tape sensor', '[02/B] PET tape sensor', '[03/B] PET tape sensor', '[04/B] PET tape sensor', '[01] Tab Direction Vision', '[02] Tab Direction Vision', 'ATR'];
    } else if (unit === 'Separator. Unwinder') {
        options = ['-', '[01/Upper] Separator. Unwinder', '[02/Upper] Separator. Unwinder', '[01/Upper] Separator. PET. Winder', '[02/Upper] Separator. PET. Winder', '[01/Lower] Separator. Unwinder', '[02/Lower] Separator. Unwinder', '[01/Lower] Separator. PET. Winder', '[02/Lower] Separator. PET. Winder', '[01/Upper] Separator. PET. Ionizer', '[02/Upper] Separator. PET. Ionizer', '[01/Lower] Separator. PET. Ionizer', '[02/Lower] Separator. PET. Ionizer', '[01/Upper] Separator. Auto Splicer Vacuum Plate', '[02/Upper] Separator. Auto Splicer Vacuum Plate', '[03/Upper] Separator. Auto Splicer Vacuum Plate', '[04/Upper] Separator. Auto Splicer Vacuum Plate', '[Upper] Separator. Auto Splicer Tape feeder', '[Upper] Separator. Auto Splicer Tape clamp', '[Upper] Separator. Auto Splicer Cutter', '[Upper] Separator. Auto Splicer Residual Sepa collector', '[Upper] Separator. Auto Splicer Residual Sepa collector', '[01/Lower] Separator. Auto Splicer vacuum plate', '[02/Lower] Separator. Auto Splicer vacuum plate', '[03/Lower] Separator. Auto Splicer  vacuum plate', '[04/Lower] Separator. Auto Splicer  vacuum plate', '[Lower] Separator. Auto Splicer Tape feeder', '[Lower] Separator. Auto Splicer Tape clamp', '[Lower] Separator. Auto Splicer Separator cutter', '[Lower ] Separator. Auto Splicer Residual Sepa collector', '[Lower] Separator. Auto Splicer Residual Sepa collector', '[01/Upper] Electrode. Manual Splicer', '[01/Center] Electrode. Manual Splicer', '[01/Upper] Separator. Winder Diameter Sensor', '[02/Upper] Separator. Winder Diameter Sensor', '[01/Lower] Separator. Winder Diameter Sensor', '[02/Lower] Separator. Winder Diameter Sensor', '[01/Upper] Separator. End Tape Sensor', '[02/Upper] Separator. End Tape Sensor', '[01/Lower] Separator. End Tape Sensor', '[02/Lower] Separator. End Tape Sensor', '[Upper] Separator. Manual Splicer', '[Lower] Separator. Manual Splicer'];
    } else if (unit === 'Electrode/Separator.Combiner') {
        options = ['-', '[Upper] Electrode. Feeding Roller', '[Center] Electrode. Feeding Roller', '[01] Electrode / Separator. Nip Roller', '[01] Electrode / Separator. Temporary Heating Roller', '[02] Electrode / Separator. Nip Roller', '[02] Electrode / Separator. Temporary Heating Roller', '[Upper] Electrode. EPC', '[Center] Electrode. EPC', '[Upper] Separator. EPC', '[Lower] Separator. EPC', '[Upper] Electrode. Cutter', '[Center] Electrode. Cutter', '[Upper] Electrode Cutting Linear', '[Center] Electrode Cutting Linear', '[Upper] Separator. Dancer', '[Lower] Separator. Dancer', '[Lower] Separator. Corona(not applied)', '[Upper] Electrode. Idle Roller', '[Center] Electrode. Idle Roller', '[Upper] Separator. Idle Roller', '[Lower] Separator. Idle Roller', '[Upper] PET (Separator). Idle Roller', '[Lower] PET (Separator). Idle Roller', 'Magnet', '[02/Upper] Electrode. Manual Splicer', '[02/Center] Electrode. Manual Splicer', '[Upper] Electrode Connection PET Winder', '[Center] Electrode. V Groove Vision', '[Upper] Electrode. Connection Tape Sensor', '[Center] Electrode. Connection Tape Sensor', '[Upper] Separator. Connection Tape Sensor', '[Lower] Separator. Connection Tape Sensor', '[Upper] Electrode. Stopper', '[Center] Electrode. Stopper', '[Upper] Separator. KANSEN Expander Roller', '[Lower] Separator. KANSEN Expander Roller'];
    } else if (unit === 'Laminator') {
        options = ['-', '[01/Upper] Heating Zone', '[01/Lower] Heating Zone', '[Upper] Sub Heater', '[Lower] Sub Heater', '[Upper] Lamination Roller', '[Lower] Lamination Roller', '[a] PET. Cleaner', '[b] PET. Cleaner', '[c] PET. Cleaner', '[d] PET. Cleaner', '[01/Upper] PET. Dancer', '[02/Upper] PET. Dancer', '[01/Lower] PET. Dancer', '[02/Lower] PET. Dancer', '[Upper] PET. Unwinder', '[Lower] PET. Unwinder', '[Upper] PET. Winder', '[Lower] PET. Winder', 'Uncut Cell. Dancer', '[Upper] PET. Splicer(Manual)', '[Lower] PET. Splicer(Manual)', 'Separator. Sealer', 'Separator. Sealing Linear', 'Uncut Cell. Air Blow/Suction', 'Uncut Cell. Union Vision (#합치)', '[01/Upper] PET. Ionizer', '[02/Upper] PET. Ionizer', '[01/Lower] PET. Ionizer', '[02/Lower] PET. Ionizer', '[Upper] PET. Idle Roller', '[Lower] PET. Idle Roller', 'Magnet', '[Upper] Separator. Longside Sealer', '[Lower] Separator. Longside Sealer', 'Separator. Longside Sealer. Vision', '[Upper] Sub Roller', '[Lower] Sub Roller', 'Particle Prevention Unit'];
    } else if (unit === 'Cell.FinalCutter') {
        options = ['-', 'Uncut Cell. Conveyor', 'Cell. Grip Nip Roller', 'Cell. Cutter', 'Electrode. Cutting Linear'];
    } else if (unit === 'Cell.TrackingSystem') {
        options = ['-', 'Cell. BCR'];
    } else if (unit === 'Cell.Inspector') {
        options = ['-', 'Cell. Suction Conveyor', 'Cell. Short Inspector', 'Cell. Vision Inspector', 'Cell. NG Mark Vision', 'Cell. Short Inspector Linear', 'Cell. Vision Inspector Linear', 'Cell. Blow & Suction', 'Cell. Thickness Sensor'];
    } else if (unit === 'Cell.Unloader') {
        options = ['-', '[01] NG Cell. Pusher', '[02] NG Cell. Pusher', '[03] NG Cell. Pusher', '[01] NG Cell. Box', '[02] NG Cell. Box', '[03] NG Cell. Box', 'Cell. Suction Conveyor', 'OK Cell. Pusher'];
    } else if (unit === '[01]Cell.Loading C/V') {
        options = ['-', '[Lower] Cell. Loading C/V'];
    } else if (unit === '[02]Cell.Loading C/V') {
        options = ['-', '[Upper] Cell. Loading C/V', '[01] Cell. NG Box', '[02] Cell. NG Box', 'Cell. Lower Separator Vision'];
    } else if (unit === '[01]Cell.Stacker') {
        options = ['-', 'Cell. Pusher', '[01/A] Cell. Gripper', '[02/A] Cell. Gripper', '[03/A] Cell. Gripper', '[01/B] Cell. Gripper', '[02/B] Cell. Gripper', '[03/B] Cell. Gripper', 'Cell. Align Vision', 'Cell. Align Table', 'Table Transfer Linear', 'Cell. Stack Vision'];
    } else if (unit === '[02]Cell.Stacker') {
        options = ['-', 'Cell. Pusher', '[01/A] Cell. Gripper', '[02/A] Cell. Gripper', '[03/A] Cell. Gripper', '[01/B] Cell. Gripper', '[02/B] Cell. Gripper', '[03/B] Cell. Gripper', 'Cell. Align Vision', 'Cell. Align Table', 'Table Transfer Linear', 'Cell. Stack Vision'];
    } else if (unit === '[03]Cell.Stacker') {
        options = ['-', 'Cell. Pusher', '[01/A] Cell. Gripper', '[02/A] Cell. Gripper', '[03/A] Cell. Gripper', '[01/B] Cell. Gripper', '[02/B] Cell. Gripper', '[03/B] Cell. Gripper', 'Cell. Align Vision', 'Cell. Align Table', 'Table Transfer Linear', 'Cell. Stack Vision'];
    } else if (unit === 'Stacked Cell.Transfer') {
        options = ['-', 'Stacked Cell. Transfer', 'Stacked Cell. Gripper'];
    } else if (unit === 'HalfCell.Loading') {
        options = ['-', '[A] Half Cell. Magazine', '[B] Half Cell. Magazine', '[C] Half Cell. Magazine', 'Half Cell. Vibrator', 'Half Cell. Pick & Place', 'Half Cell. Thickness Inspector', 'Half Cell. Rotate', '[A] Half Cell. NG Box', '[B] Half Cell. NG Box'];
    } else if (unit === 'HalfCell.Stack') {
        options = ['-', 'Half Cell. Buffer Table', 'Half Cell. Vision NG Box', 'Half Cell. Scara Robot', 'Half Cell. Vision'];
    } else if (unit === 'LMS') {
        options = ['-', 'Stacked Cell. Shuttle', '[01] LMS. Stacked Cell Clamp Air Supply', '[02] LMS. Stacked Cell Clamp Air Supply', '[03] LMS. Stacked Cell Clamp Air Supply', '[04] LMS. Stacked Cell Clamp Air Supply', '[05] LMS. Stacked Cell Clamp Air Supply', 'Shuttle. In Lift', 'Shuttle. Out Lift', 'Shuttle. Blow & Suction Cleaner', 'Shuttle. Buffer01', 'Shuttle. Buffer02', 'Stacked Cell. NG Pick & Place', 'Stacked Cell. NG Box', 'Stacked Cell. Rotate', 'Stacked Cell. BCR'];
    } else if (unit === '[01]StackedCell.Taper') {
        options = ['-', 'Stacked Cell. Press', '[01] Tape. Attacher', '[02] Tape. Attacher', '[03] Tape. Attacher', '[04] Tape. Attacher', '[05] Tape. Attacher', '[06] Tape. Attacher', '[01] Tape. Upper Clamp', '[02] Tape. Upper Clamp', '[03] Tape. Upper Clamp', '[04] Tape. Upper Clamp', '[05] Tape. Upper Clamp', '[06] Tape. Upper Clamp', '[01] Tape. Lower Clamp', '[02] Tape. Lower Clamp', '[03] Tape. Lower Clamp', '[04] Tape. Lower Clamp', '[05] Tape. Lower Clamp', '[06] Tape. Lower Clamp', '[01] Tape. Tape Supply', '[02] Tape. Tape Supply', '[03] Tape. Tape Supply', '[04] Tape. Tape Supply', '[05] Tape. Tape Supply', '[06] Tape. Tape Supply', '[01] Tape. Cutter', '[02] Tape. Cutter', '[03] Tape. Cutter', '[04] Tape. Cutter', '[05] Tape. Cutter', '[06] Tape. Cutter', 'NG Tape. Receiver'];
    } else if (unit === '[02]StackedCell.Taper') {
        options = ['-', 'Stacked Cell. Press', '[01] Tape. Attacher', '[02] Tape. Attacher', '[03] Tape. Attacher', '[04] Tape. Attacher', '[05] Tape. Attacher', '[06] Tape. Attacher', '[01] Tape. Upper Clamp', '[02] Tape. Upper Clamp', '[03] Tape. Upper Clamp', '[04] Tape. Upper Clamp', '[05] Tape. Upper Clamp', '[06] Tape. Upper Clamp', '[01] Tape. Lower Clamp', '[02] Tape. Lower Clamp', '[03] Tape. Lower Clamp', '[04] Tape. Lower Clamp', '[05] Tape. Lower Clamp', '[06] Tape. Lower Clamp', '[01] Tape. Tape Supply', '[02] Tape. Tape Supply', '[03] Tape. Tape Supply', '[04] Tape. Tape Supply', '[05] Tape. Tape Supply', '[06] Tape. Tape Supply', '[01] Tape. Cutter', '[02] Tape. Cutter', '[03] Tape. Cutter', '[04] Tape. Cutter', '[05] Tape. Cutter', '[06] Tape. Cutter', 'NG Tape. Receiver'];
    } else if (unit === 'TapedCell.Vision') {
        options = ['-', '[01] Taped Cell. Pick & Place', '[Upper/Lower] Taped Cell. Vision', '[4-side] Taped Cell. Vision', 'Taped Cell. Rotating Table', '[02] Taped Cell. Pick & Place', 'Taped Cell. Weight Inspector'];
    } else if (unit === 'TapedCell.Rotate') {
        options = ['-', 'TapedCell.Rotate'];
    } else if (unit === 'TapedCell.ShortInspector') {
        options = ['-', 'Taped Cell. Shuttle', 'Taped Cell. Short, Thickness Inspector'];
    } else if (unit === 'Cell.TrackingSystem') {
        options = ['-', '[01] Cell. BCR', '[02] Cell. BCR'];
    } else if (unit === 'TapedCell.Transfer') {
        options = ['-', 'NG Taped Cell. Transfer', '[01] NG Box', '[02] NG Box', '[03] NG Box', '[04] NG Box', 'NG Box Transfer', 'OK Taped Cell. Transfer', 'Taped Cell. Conveyor', 'Taped Cell. Align'];
    } else if (unit === 'TapedCell.Unloader') {
        options = ['-', 'Taped Cell. Pick & Place', '[01] Taped Cell. Lift', '[02] Taped Cell. Lift', '[01] Tray(Empty). Conveyor', '[02] Tray(Empty). Conveyor', 'Tray(Empty). Conveyor', 'Tray. Conveyor', '[A] Tray. Lift', '[B] Tray. Lift', 'Tray. Cleaner', 'Tray. Conveyor Free Roller', 'Tray(Empty). Conveyor Free Roller'];
    } else {
        options = ['-'];
    }

    options.forEach(function (opt) {
        const option = document.createElement('option');
        option.value = opt;
        option.textContent = opt;
        assySelect.appendChild(option);
    });
});

// trouble-assy 연동 (Unit에 따라 Assy 설정)
document.getElementById('trouble-unit').addEventListener('change', function () {
    const unit = this.value;
    const assySelect = document.getElementById('trouble-assy');
    assySelect.innerHTML = '';

    let options = [];
    if (unit === 'Pancake.Loader') {
        options = ['-', '[01/A] Pancake. Conveyor', '[01/B] Pancake. Conveyor', '[01/C] Pancake. Conveyor', '[02/A] Pancake. Conveyor', '[02B] Pancake. Conveyor', '[02/C] Pancake. Conveyor', 'Pancake. Hoist', '[01/A] Pancake. Unwinder', '[02/A] Pancake. Unwinder', '[03/A] Pancake. Unwinder', '[04/A] Pancake. Unwinder', '[01/B] Pancake. Unwinder', '[02/B] Pancake. Unwinder', '[03/B] Pancake. Unwinder', '[04/B] Pancake. Unwinder', '[01/A] Electrode. Vacuum Plate', '[02/A] Electrode. Vacuum Plate', '[03/A] Electrode. Vacuum Plate', '[04/A] Electrode. Vacuum Plate', '[01/B] Electrode. Vacuum Plate', '[02/B] Electrode. Vacuum Plate', '[03/B] Electrode. Vacuum Plate', '[04/B] Electrode. Vacuum Plate', '[01/A] Electrode. Auto Splicer Cutter', '[02/A] Electrode. Auto Splicer Cutter', '[03/A] Electrode. Auto Splicer Cutter', '[04/A] Electrode. Auto Splicer Cutter', '[01/B] Electrode. Auto Splicer Cutter', '[02/B] Electrode. Auto Splicer Cutter', '[03/B] Electrode. Auto Splicer Cutter', '[04/B] Electrode. Auto Splicer Cutter', 'Electrode. Tape Feeder', 'Electrode. Scrape Box', '[01/A] Electrode. Idle Roller', '[02/A] Electrode. Idle Roller', '[01/B] Electrode. Idle Roller', '[02/B] Electrode. Idle Roller', '[01/A] Dancer. Roller', '[02/A] Dancer. Roller', '[01/B] Dancer. Roller', '[02/B] Dancer. Roller', '[01/A] Adjust Roller', '[02/A] Adjust Roller', '[01/B] Adjust Roller', '[02/B] Adjust Roller', '[01/A] Electrode. EPC', '[02/A] Electrode. EPC', '[03/A] Electrode. EPC', '[04/A] Electrode. EPC', '[01/B] Electrode. EPC', '[02/B] Electrode. EPC', '[03/B] Electrode. EPC', '[04/B] Electrode. EPC', '[01/A] Winder Diameter Sensor', '[02/A] Winder Diameter Sensor', '[03/A] Winder Diameter Sensor', '[04/A] Winder Diameter Sensor', '[01/B] Winder Diameter Sensor', '[02/B] Winder Diameter Sensor', '[03/B] Winder Diameter Sensor', '[04/B] Winder Diameter Sensor', '[01/A] PET tape sensor', '[02/A] PET tape sensor', '[03/A] PET tape sensor', '[04/A] PET tape sensor', '[01/B] PET tape sensor', '[02/B] PET tape sensor', '[03/B] PET tape sensor', '[04/B] PET tape sensor', '[01] Tab Direction Vision', '[02] Tab Direction Vision', 'ATR'];
    } else if (unit === 'Separator. Unwinder') {
        options = ['-', '[01/Upper] Separator. Unwinder', '[02/Upper] Separator. Unwinder', '[01/Upper] Separator. PET. Winder', '[02/Upper] Separator. PET. Winder', '[01/Lower] Separator. Unwinder', '[02/Lower] Separator. Unwinder', '[01/Lower] Separator. PET. Winder', '[02/Lower] Separator. PET. Winder', '[01/Upper] Separator. PET. Ionizer', '[02/Upper] Separator. PET. Ionizer', '[01/Lower] Separator. PET. Ionizer', '[02/Lower] Separator. PET. Ionizer', '[01/Upper] Separator. Auto Splicer Vacuum Plate', '[02/Upper] Separator. Auto Splicer Vacuum Plate', '[03/Upper] Separator. Auto Splicer Vacuum Plate', '[04/Upper] Separator. Auto Splicer Vacuum Plate', '[Upper] Separator. Auto Splicer Tape feeder', '[Upper] Separator. Auto Splicer Tape clamp', '[Upper] Separator. Auto Splicer Cutter', '[Upper] Separator. Auto Splicer Residual Sepa collector', '[Upper] Separator. Auto Splicer Residual Sepa collector', '[01/Lower] Separator. Auto Splicer vacuum plate', '[02/Lower] Separator. Auto Splicer vacuum plate', '[03/Lower] Separator. Auto Splicer  vacuum plate', '[04/Lower] Separator. Auto Splicer  vacuum plate', '[Lower] Separator. Auto Splicer Tape feeder', '[Lower] Separator. Auto Splicer Tape clamp', '[Lower] Separator. Auto Splicer Separator cutter', '[Lower ] Separator. Auto Splicer Residual Sepa collector', '[Lower] Separator. Auto Splicer Residual Sepa collector', '[01/Upper] Electrode. Manual Splicer', '[01/Center] Electrode. Manual Splicer', '[01/Upper] Separator. Winder Diameter Sensor', '[02/Upper] Separator. Winder Diameter Sensor', '[01/Lower] Separator. Winder Diameter Sensor', '[02/Lower] Separator. Winder Diameter Sensor', '[01/Upper] Separator. End Tape Sensor', '[02/Upper] Separator. End Tape Sensor', '[01/Lower] Separator. End Tape Sensor', '[02/Lower] Separator. End Tape Sensor', '[Upper] Separator. Manual Splicer', '[Lower] Separator. Manual Splicer'];
    } else if (unit === 'Electrode/Separator.Combiner') {
        options = ['-', '[Upper] Electrode. Feeding Roller', '[Center] Electrode. Feeding Roller', '[01] Electrode / Separator. Nip Roller', '[01] Electrode / Separator. Temporary Heating Roller', '[02] Electrode / Separator. Nip Roller', '[02] Electrode / Separator. Temporary Heating Roller', '[Upper] Electrode. EPC', '[Center] Electrode. EPC', '[Upper] Separator. EPC', '[Lower] Separator. EPC', '[Upper] Electrode. Cutter', '[Center] Electrode. Cutter', '[Upper] Electrode Cutting Linear', '[Center] Electrode Cutting Linear', '[Upper] Separator. Dancer', '[Lower] Separator. Dancer', '[Lower] Separator. Corona(not applied)', '[Upper] Electrode. Idle Roller', '[Center] Electrode. Idle Roller', '[Upper] Separator. Idle Roller', '[Lower] Separator. Idle Roller', '[Upper] PET (Separator). Idle Roller', '[Lower] PET (Separator). Idle Roller', 'Magnet', '[02/Upper] Electrode. Manual Splicer', '[02/Center] Electrode. Manual Splicer', '[Upper] Electrode Connection PET Winder', '[Center] Electrode. V Groove Vision', '[Upper] Electrode. Connection Tape Sensor', '[Center] Electrode. Connection Tape Sensor', '[Upper] Separator. Connection Tape Sensor', '[Lower] Separator. Connection Tape Sensor', '[Upper] Electrode. Stopper', '[Center] Electrode. Stopper', '[Upper] Separator. KANSEN Expander Roller', '[Lower] Separator. KANSEN Expander Roller'];
    } else if (unit === 'Laminator') {
        options = ['-', '[01/Upper] Heating Zone', '[01/Lower] Heating Zone', '[Upper] Sub Heater', '[Lower] Sub Heater', '[Upper] Lamination Roller', '[Lower] Lamination Roller', '[a] PET. Cleaner', '[b] PET. Cleaner', '[c] PET. Cleaner', '[d] PET. Cleaner', '[01/Upper] PET. Dancer', '[02/Upper] PET. Dancer', '[01/Lower] PET. Dancer', '[02/Lower] PET. Dancer', '[Upper] PET. Unwinder', '[Lower] PET. Unwinder', '[Upper] PET. Winder', '[Lower] PET. Winder', 'Uncut Cell. Dancer', '[Upper] PET. Splicer(Manual)', '[Lower] PET. Splicer(Manual)', 'Separator. Sealer', 'Separator. Sealing Linear', 'Uncut Cell. Air Blow/Suction', 'Uncut Cell. Union Vision (#합치)', '[01/Upper] PET. Ionizer', '[02/Upper] PET. Ionizer', '[01/Lower] PET. Ionizer', '[02/Lower] PET. Ionizer', '[Upper] PET. Idle Roller', '[Lower] PET. Idle Roller', 'Magnet', '[Upper] Separator. Longside Sealer', '[Lower] Separator. Longside Sealer', 'Separator. Longside Sealer. Vision', '[Upper] Sub Roller', '[Lower] Sub Roller', 'Particle Prevention Unit'];
    } else if (unit === 'Cell.FinalCutter') {
        options = ['-', 'Uncut Cell. Conveyor', 'Cell. Grip Nip Roller', 'Cell. Cutter', 'Electrode. Cutting Linear'];
    } else if (unit === 'Cell.TrackingSystem') {
        options = ['-', 'Cell. BCR'];
    } else if (unit === 'Cell.Inspector') {
        options = ['-', 'Cell. Suction Conveyor', 'Cell. Short Inspector', 'Cell. Vision Inspector', 'Cell. NG Mark Vision', 'Cell. Short Inspector Linear', 'Cell. Vision Inspector Linear', 'Cell. Blow & Suction', 'Cell. Thickness Sensor'];
    } else if (unit === 'Cell.Unloader') {
        options = ['-', '[01] NG Cell. Pusher', '[02] NG Cell. Pusher', '[03] NG Cell. Pusher', '[01] NG Cell. Box', '[02] NG Cell. Box', '[03] NG Cell. Box', 'Cell. Suction Conveyor', 'OK Cell. Pusher'];
    } else if (unit === '[01]Cell.Loading C/V') {
        options = ['-', '[Lower] Cell. Loading C/V'];
    } else if (unit === '[02]Cell.Loading C/V') {
        options = ['-', '[Upper] Cell. Loading C/V', '[01] Cell. NG Box', '[02] Cell. NG Box', 'Cell. Lower Separator Vision'];
    } else if (unit === '[01]Cell.Stacker') {
        options = ['-', 'Cell. Pusher', '[01/A] Cell. Gripper', '[02/A] Cell. Gripper', '[03/A] Cell. Gripper', '[01/B] Cell. Gripper', '[02/B] Cell. Gripper', '[03/B] Cell. Gripper', 'Cell. Align Vision', 'Cell. Align Table', 'Table Transfer Linear', 'Cell. Stack Vision'];
    } else if (unit === '[02]Cell.Stacker') {
        options = ['-', 'Cell. Pusher', '[01/A] Cell. Gripper', '[02/A] Cell. Gripper', '[03/A] Cell. Gripper', '[01/B] Cell. Gripper', '[02/B] Cell. Gripper', '[03/B] Cell. Gripper', 'Cell. Align Vision', 'Cell. Align Table', 'Table Transfer Linear', 'Cell. Stack Vision'];
    } else if (unit === '[03]Cell.Stacker') {
        options = ['-', 'Cell. Pusher', '[01/A] Cell. Gripper', '[02/A] Cell. Gripper', '[03/A] Cell. Gripper', '[01/B] Cell. Gripper', '[02/B] Cell. Gripper', '[03/B] Cell. Gripper', 'Cell. Align Vision', 'Cell. Align Table', 'Table Transfer Linear', 'Cell. Stack Vision'];
    } else if (unit === 'Stacked Cell.Transfer') {
        options = ['-', 'Stacked Cell. Transfer', 'Stacked Cell. Gripper'];
    } else if (unit === 'HalfCell.Loading') {
        options = ['-', '[A] Half Cell. Magazine', '[B] Half Cell. Magazine', '[C] Half Cell. Magazine', 'Half Cell. Vibrator', 'Half Cell. Pick & Place', 'Half Cell. Thickness Inspector', 'Half Cell. Rotate', '[A] Half Cell. NG Box', '[B] Half Cell. NG Box'];
    } else if (unit === 'HalfCell.Stack') {
        options = ['-', 'Half Cell. Buffer Table', 'Half Cell. Vision NG Box', 'Half Cell. Scara Robot', 'Half Cell. Vision'];
    } else if (unit === 'LMS') {
        options = ['-', 'Stacked Cell. Shuttle', '[01] LMS. Stacked Cell Clamp Air Supply', '[02] LMS. Stacked Cell Clamp Air Supply', '[03] LMS. Stacked Cell Clamp Air Supply', '[04] LMS. Stacked Cell Clamp Air Supply', '[05] LMS. Stacked Cell Clamp Air Supply', 'Shuttle. In Lift', 'Shuttle. Out Lift', 'Shuttle. Blow & Suction Cleaner', 'Shuttle. Buffer01', 'Shuttle. Buffer02', 'Stacked Cell. NG Pick & Place', 'Stacked Cell. NG Box', 'Stacked Cell. Rotate', 'Stacked Cell. BCR'];
    } else if (unit === '[01]StackedCell.Taper') {
        options = ['-', 'Stacked Cell. Press', '[01] Tape. Attacher', '[02] Tape. Attacher', '[03] Tape. Attacher', '[04] Tape. Attacher', '[05] Tape. Attacher', '[06] Tape. Attacher', '[01] Tape. Upper Clamp', '[02] Tape. Upper Clamp', '[03] Tape. Upper Clamp', '[04] Tape. Upper Clamp', '[05] Tape. Upper Clamp', '[06] Tape. Upper Clamp', '[01] Tape. Lower Clamp', '[02] Tape. Lower Clamp', '[03] Tape. Lower Clamp', '[04] Tape. Lower Clamp', '[05] Tape. Lower Clamp', '[06] Tape. Lower Clamp', '[01] Tape. Tape Supply', '[02] Tape. Tape Supply', '[03] Tape. Tape Supply', '[04] Tape. Tape Supply', '[05] Tape. Tape Supply', '[06] Tape. Tape Supply', '[01] Tape. Cutter', '[02] Tape. Cutter', '[03] Tape. Cutter', '[04] Tape. Cutter', '[05] Tape. Cutter', '[06] Tape. Cutter', 'NG Tape. Receiver'];
    } else if (unit === '[02]StackedCell.Taper') {
        options = ['-', 'Stacked Cell. Press', '[01] Tape. Attacher', '[02] Tape. Attacher', '[03] Tape. Attacher', '[04] Tape. Attacher', '[05] Tape. Attacher', '[06] Tape. Attacher', '[01] Tape. Upper Clamp', '[02] Tape. Upper Clamp', '[03] Tape. Upper Clamp', '[04] Tape. Upper Clamp', '[05] Tape. Upper Clamp', '[06] Tape. Upper Clamp', '[01] Tape. Lower Clamp', '[02] Tape. Lower Clamp', '[03] Tape. Lower Clamp', '[04] Tape. Lower Clamp', '[05] Tape. Lower Clamp', '[06] Tape. Lower Clamp', '[01] Tape. Tape Supply', '[02] Tape. Tape Supply', '[03] Tape. Tape Supply', '[04] Tape. Tape Supply', '[05] Tape. Tape Supply', '[06] Tape. Tape Supply', '[01] Tape. Cutter', '[02] Tape. Cutter', '[03] Tape. Cutter', '[04] Tape. Cutter', '[05] Tape. Cutter', '[06] Tape. Cutter', 'NG Tape. Receiver'];
    } else if (unit === 'TapedCell.Vision') {
        options = ['-', '[01] Taped Cell. Pick & Place', '[Upper/Lower] Taped Cell. Vision', '[4-side] Taped Cell. Vision', 'Taped Cell. Rotating Table', '[02] Taped Cell. Pick & Place', 'Taped Cell. Weight Inspector'];
    } else if (unit === 'TapedCell.Rotate') {
        options = ['-', 'TapedCell.Rotate'];
    } else if (unit === 'TapedCell.ShortInspector') {
        options = ['-', 'Taped Cell. Shuttle', 'Taped Cell. Short, Thickness Inspector'];
    } else if (unit === 'Cell.TrackingSystem') {
        options = ['-', '[01] Cell. BCR', '[02] Cell. BCR'];
    } else if (unit === 'TapedCell.Transfer') {
        options = ['-', 'NG Taped Cell. Transfer', '[01] NG Box', '[02] NG Box', '[03] NG Box', '[04] NG Box', 'NG Box Transfer', 'OK Taped Cell. Transfer', 'Taped Cell. Conveyor', 'Taped Cell. Align'];
    } else if (unit === 'TapedCell.Unloader') {
        options = ['-', 'Taped Cell. Pick & Place', '[01] Taped Cell. Lift', '[02] Taped Cell. Lift', '[01] Tray(Empty). Conveyor', '[02] Tray(Empty). Conveyor', 'Tray(Empty). Conveyor', 'Tray. Conveyor', '[A] Tray. Lift', '[B] Tray. Lift', 'Tray. Cleaner', 'Tray. Conveyor Free Roller', 'Tray(Empty). Conveyor Free Roller'];
    } else {
        options = ['-'];
    }

    options.forEach(function (opt) {
        const option = document.createElement('option');
        option.value = opt;
        option.textContent = opt;
        assySelect.appendChild(option);
    });
});







        // 페이지 로드 시 현재 시간 설정
        window.onload = function() {
            setCurrentDateTime('para-time');
            setCurrentDateTime('trouble-time');
            setCurrentDateTime('trouble-complete');
        };
        
        // 현재 시간 설정 함수
        function setCurrentDateTime(elementId) {
            const now = new Date();
            const year = now.getFullYear();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            
            const dateTimeValue = `${year}-${month}-${day}T${hours}:${minutes}`;
            document.getElementById(elementId).value = dateTimeValue;
        }
        
        // 탭 전환 함수
        function switchTab(formId) {
            // 모든 탭과 폼 비활성화
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.form').forEach(form => {
                form.classList.remove('active');
            });
            
            // 선택된 탭과 폼 활성화
            if (formId === 'parameterForm') {
                document.querySelectorAll('.tab')[0].classList.add('active');
                document.getElementById('parameterForm').classList.add('active');
            } else {
                document.querySelectorAll('.tab')[1].classList.add('active');
                document.getElementById('troubleForm').classList.add('active');
            }
            
            // 결과 숨기기
            document.getElementById('result').style.display = 'none';
        }
        
        // 날짜 형식화 함수
        function formatDateTime(dateTimeStr) {
            if (!dateTimeStr) return '';
            
            const date = new Date(dateTimeStr);
            const year = date.getFullYear();
            const month = date.getMonth() + 1;
            const day = date.getDate();
            const hours = date.getHours();
            const minutes = String(date.getMinutes()).padStart(2, '0');
            
            const ampm = hours >= 12 ? '오후' : '오전';
            const hour12 = hours % 12 || 12;
            
            return `${year}년 ${month}월 ${day}일 ${ampm} ${hour12}:${minutes}`;
        }
        
        // 파라미터 변경 양식 생성 함수
        function generateParameterText() {
            const machine = document.getElementById('para-machine').value;
            const process = document.getElementById('para-process').value;
            const unit = document.getElementById('para-unit').value;
            const assy = document.getElementById('para-assy').value;
            const time = formatDateTime(document.getElementById('para-time').value);
            const parameter = document.getElementById('para-parameter').value;
            const before = document.getElementById('para-before').value;
            const after = document.getElementById('para-after').value;
            const worker = document.getElementById('para-worker').value;
            const reason = document.getElementById('para-reason').value;
            
            let text = `■ 파라미터, IP 변경 공유\n`;
            text += `1. 호기 : ${machine}\n`;
            text += `2-1. Machine : ${process}\n`;
            text += `2-2. Unit : ${unit}\n`;
            text += `2-3. Assy' : ${assy}\n`;
            text += `3. 변경시간 : ${time}\n`;
            text += `4. 변경Para : ${parameter}\n`;
            text += `5. 이전값 : ${before}\n`;
            text += `6. 변경값 : ${after}\n`;
            text += `7. 변경자 : ${worker}\n`;
            text += `8. 변경사유 : ${reason}`;
            
            // 결과 표시
            document.getElementById('resultText').innerText = text;
            document.getElementById('result').style.display = 'block';
        }
        
        // 부동내역 양식 생성 함수
        function generateTroubleText() {
            const type = document.getElementById('trouble-type').value;
            const machine = document.getElementById('trouble-machine').value;
            const process = document.getElementById('trouble-process').value;
            const unit = document.getElementById('trouble-unit').value;
            const assy = document.getElementById('trouble-assy').value;
            const time = formatDateTime(document.getElementById('trouble-time').value);
            const complete = formatDateTime(document.getElementById('trouble-complete').value);
            const worker = document.getElementById('trouble-worker').value;
            const problem = document.getElementById('trouble-problem').value;
            const action = document.getElementById('trouble-action').value;
            
            let text = `[부동&작업 공유]\n`;
            text += `종류: ${type}\n`;
            text += `1. 호기: ${machine}\n`;
            text += `2-1. Machine: ${process}\n`;
            text += `2-2. Unit: ${unit}\n`;
            text += `2-3. Assy': ${assy}\n`;
            text += `3-1. 발생시간: ${time}\n`;
            text += `3-2. 조치완료: ${complete}\n`;
            text += `4. 작업자: ${worker}\n`;
            text += `5. 현상: ${problem}\n`;
            text += `6. 조치: ${action}`;
            
            // 결과 표시
            document.getElementById('resultText').innerText = text;
            document.getElementById('result').style.display = 'block';
        }
        
        // 텍스트 복사 함수
        function copyText() {
            const text = document.getElementById('resultText').innerText;
            navigator.clipboard.writeText(text)
                .then(() => {
                    alert('텍스트가 클립보드에 복사되었습니다.');
                })
                .catch(err => {
                    console.error('클립보드 복사 실패:', err);
                    alert('클립보드 복사에 실패했습니다. 수동으로 텍스트를 선택하여 복사하세요.');
                });
        }
        
        // 공유하기 함수
        function shareContent() {
            const text = document.getElementById('resultText').innerText;
            const title = 'ESMI2 JF2 공유 내용';
            
            // Web Share API 지원 확인
            if (navigator.share) {
                navigator.share({
                    title: title,
                    text: text
                })
                .then(() => {
                    console.log('공유 성공');
                })
                .catch((error) => {
                    console.log('공유 실패:', error);
                    // 공유 실패 시 클립보드에 복사
                    fallbackToCopy(text);
                });
            } else {
                // Web Share API를 지원하지 않는 경우 클립보드에 복사
                fallbackToCopy(text);
            }
        }
        
        // 클립보드 복사 대체 방법
        function fallbackToCopy(text) {
            navigator.clipboard.writeText(text)
                .then(() => {
                    alert('텍스트가 클립보드에 복사되었습니다.');
                })
                .catch(err => {
                    console.error('클립보드 복사 실패:', err);
                    alert('클립보드 복사에 실패했습니다. 수동으로 텍스트를 선택하여 복사하세요.');
                });
        }
    </script>


</body></html>